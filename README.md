# SM-24 Geophone Early Earthquake Detection on Raspberry Pi Pico 2 (RP2350)

## Project overview
This project turns a Raspberry Pi Pico 2 (RP2350) and an SM-24 geophone into a standalone, low-power seismic node that can detect earthquakes and distinguish them from everyday vibrations using Edge Impulse. The model is trained in Edge Impulse and deployed as a C++ library running fully on-device, with real-time inference on streaming geophone data.

The system is designed for:

* Early detection of seismic activity using a professional geophone (SM-24).

* Fully offline inference on the RP2350 microcontroller.

* Clear, multi-level alerts via LEDs and a buzzer for different confidence levels.

## Motivation
* Traditional seismic stations are expensive and power hungry.

* Many low-cost “earthquake” sensors use MEMS accelerometers with limited low-frequency performance.

* SM-24 geophones are widely used in seismology and have excellent sensitivity in the 10–240 Hz band, making them ideal for local earthquake and tremor detection.

* Edge Impulse makes it practical to train and deploy a robust classifier that runs on a tiny microcontroller at the edge.

The goal is to show that a sub‑$20 MCU + geophone + ML can provide useful local seismic awareness without internet connectivity or high power.
  
## Requirements

### Hardware

* [Raspberry Pi Pico 2W](https://www.raspberrypi.com/products/raspberry-pi-pico-2/).
* [Geophone- SM-24, with insulating disc](https://www.sparkfun.com/geophone-sm-24-with-insulating-disc.html).
* [INA333 Low-Power, Zero-Drift, Precision Instrumentation Amplifier](https://www.ti.com/product/INA333).

### Software

* [Edge Impulse CLI](https://docs.edgeimpulse.com/docs/cli-installation).
* [GNU ARM Embedded Toolchain](https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads).
* [CMake](https://cmake.org/install/).
* [Rasperry Pi Pico SDK](https://www.raspberrypi.com/documentation/microcontrollers/c_sdk.html).

## Data & Model
### Data source
This project uses the STEAD (STanford EArthquake Dataset) as the primary training source. STEAD provides labeled seismic waveforms for earthquakes and non‑earthquake signals across many stations and conditions.​

* The original STEAD distribution is provided in HDF5 (.hdf5) format. For easier experimentation, faster loading, and integration with the Edge Impulse ingestion scripts, the raw HDF5 files were converted into compressed NumPy .npz arrays:

    * HDF5 → NumPy arrays using h5py and numpy.

    * Arrays saved as .npz for:

    * Faster random access during preprocessing.

    * Simpler slicing, labeling, and balancing of classes.

    * Reduced I/O overhead when generating training and validation sets.​

* From these .npz files, preprocessed segments were created and exported to Edge Impulse as time‑series samples with labels such as:

    * earthquake

    * noise
 
* The data preparation (Conversion) is done in the file --data-prep/dataset-npz.ipynb and data uploading is done in the file --data-prep/new-earthquake.ipynb

### Spectral preprocessing
To make the model robust and efficient on the RP2350, the raw time‑series from the STEAD .npz arrays are first transformed using spectral analysis before entering the neural network:

* A spectral preprocessing pipeline computes frequency‑domain features from each window:

    * Apply a window function.

    * Compute FFT / power spectrum over the segment.

    * Optionally aggregate into frequency bands relevant for local seismic events.

    * Normalize or log‑scale spectral amplitudes.

These spectral features are then reshaped to a fixed length and fed as a 1D sequence into the Keras model.

On-device, the same spectral preprocessing graph generated by Edge Impulse runs before inference, so the RP2350 executes both:

* DSP (spectral analysis) on the incoming SM‑24 geophone window.

* Neural network inference on the resulting spectral feature vector.

### Input representation
* The resulting .npz files are uploaded to Edge Impulse where they are windowed into time-series samples.

    * Input Type: Raw Time-series (1-axis).

    * Window Size: 56 samples (Optimized for P-wave arrival detection).

    * Classes: earthquake, noise, local_event.

### Model Architecture
We implemented a custom Keras architecture optimized for the RP2350. It uses a "MobileNet-style" block with Depthwise Separable Convolutions to minimize parameter count and maximize inference speed.
[Model Image](![](tflite_learn_815551_95.jpg))